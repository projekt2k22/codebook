<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Counting Derangements | Project 2K22</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Counting Derangements" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In combinatorial mathematics, a derangement is a permutation of the elements of a set, such that no element appears in its original position. In other words, a derangement is a permutation that has no fixed points (wiki)." />
<meta property="og:description" content="In combinatorial mathematics, a derangement is a permutation of the elements of a set, such that no element appears in its original position. In other words, a derangement is a permutation that has no fixed points (wiki)." />
<link rel="canonical" href="https://projekt2k22.github.io/codebook/jupyter/dynamic%20programming/counting/combinatorial/2021/02/11/Counting-Derangements.html" />
<meta property="og:url" content="https://projekt2k22.github.io/codebook/jupyter/dynamic%20programming/counting/combinatorial/2021/02/11/Counting-Derangements.html" />
<meta property="og:site_name" content="Project 2K22" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-11T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://projekt2k22.github.io/codebook/jupyter/dynamic%20programming/counting/combinatorial/2021/02/11/Counting-Derangements.html","@type":"BlogPosting","headline":"Counting Derangements","dateModified":"2021-02-11T00:00:00-06:00","datePublished":"2021-02-11T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://projekt2k22.github.io/codebook/jupyter/dynamic%20programming/counting/combinatorial/2021/02/11/Counting-Derangements.html"},"description":"In combinatorial mathematics, a derangement is a permutation of the elements of a set, such that no element appears in its original position. In other words, a derangement is a permutation that has no fixed points (wiki).","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/codebook/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://projekt2k22.github.io/codebook/feed.xml" title="Project 2K22" /><link rel="shortcut icon" type="image/x-icon" href="/codebook/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" /><script src="https://hypothes.is/embed.js" async></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/codebook/">Project 2K22</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/codebook/about/">About Me</a><a class="page-link" href="/codebook/search/">Search</a><a class="page-link" href="/codebook/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Counting Derangements</h1><p class="page-description">In combinatorial mathematics, a derangement is a permutation of the elements of a set, such that no element appears in its original position. In other words, a derangement is a permutation that has no fixed points (wiki).</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-02-11T00:00:00-06:00" itemprop="datePublished">
        Feb 11, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/codebook/categories/#jupyter">jupyter</a>
        &nbsp;
      
        <a class="category-tags-link" href="/codebook/categories/#dynamic programming">dynamic programming</a>
        &nbsp;
      
        <a class="category-tags-link" href="/codebook/categories/#counting">counting</a>
        &nbsp;
      
        <a class="category-tags-link" href="/codebook/categories/#combinatorial">combinatorial</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/projekt2k22/codebook/tree/master/_notebooks/2021-02-11-Counting-Derangements.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/codebook/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/projekt2k22/codebook/master?filepath=_notebooks%2F2021-02-11-Counting-Derangements.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/codebook/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/projekt2k22/codebook/blob/master/_notebooks/2021-02-11-Counting-Derangements.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/codebook/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-02-11-Counting-Derangements.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Problem">Problem<a class="anchor-link" href="#Problem"> </a></h2><p>Suppose that a professor gave a test to 4 students – A, B, C, and D – and wants to let them grade each other's tests. Of course, no student should grade his or her own test. How many ways could the professor hand the tests back to the students for grading, such that no student received his or her own test back? <a class="citation" href="#wiki_derangement">(Wikipedia contributors, 2021)</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Solution">Solution<a class="anchor-link" href="#Solution"> </a></h2><p>Counting the derangements of a set amounts to what is known as the hat-check problem, in which one considers the number of ways in which <code>n</code> hats (call them $h_1$ through $h_n$) can be returned to n people ($P_1$ through $P_n$) such that no hat makes it back to its owner.</p>
<p>Each person may receive any of the $n − 1$ hats that is not their own. Call whichever hat $P_1$ receives $h_i$ and consider $h_i$’s owner: $P_i$ receives either $P_1$'s hat, $h_1$, or some other. Accordingly, the problem splits into two possible cases:</p>
<ol>
<li><p>$P_i$ receives a hat other than $h_1$. This case is equivalent to solving the problem with $n − 1$ people and $n − 1$ hats because for each of the $n − 1$ people besides $P_1$ there is exactly one hat from among the remaining $n − 1$ hats that they may not receive (for any $P_j$ besides $P_i$, the unreceivable hat is $h_j$, while for $P_i$ it is $h_1$).</p>
</li>
<li><p>$P_i$ receives $h_1$. In this case the problem reduces to $n − 2$ people and $n − 2$ hats.</p>
</li>
</ol>
<p>For each of the $n − 1$ hats that $P_1$ may receive, the number of ways that $P_2, \dots ,P_n$ may all receive hats is the sum of the counts for the two cases. This gives us the solution to the hat-check problem: stated algebraically, the number !n of derangements of an n-element set is</p>
<p>
$$!n = (n − 1) (!(n − 1) + !(n − 2)),$$
</p>
<p>where !0 = 1 and !1 = 0.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">derangements</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
 
    <span class="c1"># create an auxiliary array to store solutions to the subproblems</span>
    <span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
 
    <span class="c1"># base case</span>
    <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
 
    <span class="c1"># fill the auxiliary array `T` in a bottom-up manner using the recurrence relation</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
 
    <span class="c1"># return the total number of derangements of an n–element set</span>
    <span class="k">return</span> <span class="n">T</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The total number of derangements of a </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">–element set is&quot;</span><span class="p">,</span> <span class="n">derangements</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The total number of derangements of a 4–element set is 9
</pre>
</div>
</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Refrences">Refrences<a class="anchor-link" href="#Refrences"> </a></h2><p><ol class="bibliography"><li><span id="wiki_derangement">Wikipedia contributors. (2021). <i>Derangement — Wikipedia, The Free Encyclopedia</i>. https://en.wikipedia.org/wiki/Derangement</span></li></ol></p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="projekt2k22/codebook"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/codebook/jupyter/dynamic%20programming/counting/combinatorial/2021/02/11/Counting-Derangements.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/codebook/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/codebook/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/codebook/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Improving myself one commit at a time.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/projekt2k22" title="projekt2k22"><svg class="svg-icon grey"><use xlink:href="/codebook/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/stochent" title="stochent"><svg class="svg-icon grey"><use xlink:href="/codebook/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
